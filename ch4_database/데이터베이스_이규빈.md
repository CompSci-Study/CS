# CS스터디 4회차 - DB

날짜: 2025년 1월 23일

# 1. DB 기본

### 용어

- **Entity**: 데이터를 저장하기 위한 실체로, 물리적 또는 개념적 대상. (예: 고객, 제품)
- **Relation(RDB - Table, NoSQL - Collection)**: 데이터를 저장하는 구조적 기본단위
- **Attribute**: Entity의 특징이나 속성을 나타내는 요소. (예: 이름, 나이)
- **Domain**: Attribute가 가질 수 있는 값의 집합. (예: 나이의 도메인은 0~120)

### Key

- **슈퍼키**: 테이블에서 행을 고유하게 식별할 수 있는 속성. (**유일성** 만족)
- **후보키**: 기본키로 사용할 수 있는 모든 키. 기본키는 후보키 중 하나를 선택하여 결정함. (**유일성 + 최소성** 만족)
- **기본키(PK)**: 테이블 내에서 각 행을 고유하게 식별하는 키. 중복 불가, NULL 불가.
- **대체키**: 후보키 중 기본키로 선택되지 않은 키.
- **외래키(FK)**: 다른 테이블의 기본키를 참조하는 키로, 테이블 간의 관계를 표현함.

# 2. ERD, 정규화

### 정의

- **ERD**: Entity 간의 관계를 정의한 다이어그램. (시스템 요구사항 → ERD → DB 구축)
- **정규화**: DB 이상현상을 해결하고 데이터를 효율적으로 저장하기 위해, 테이블을 분리하는 과정.

### 제1정규형

- **의미**: 모든 속성이 원자값만을 가져야 한다.
- **예시**: '취미' 컬럼에 여러 개의 취미를 쉼표로 구분하여 저장하지 않고, 각 취미를 별도의 행으로 분리.

### 제2정규형

- **의미**: 제1정규형을 만족하면서, 기본키의 부분 함수 종속성을 제거.
- **예시**: 주문 테이블에서 “상품 ID” 기본키에 대해 “상품 정보”가 부분 종속될 경우 상품 테이블로 분리.

### 제3정규형

- **의미**: 제2정규형을 만족하면서, 이행적 함수 종속을 제거.
- **예시**: 직원 테이블에서 “부서 ID”를 통해 “부서 이름”을 참조할 경우, 부서 테이블로 분리함.

### 보이스-코드 정규형(BCNF)

- **의미**: 제3정규형을 만족하면서 모든 결정자가 후보키여야 함.
- **예시**: 복합키 테이블에서 한 속성이 다른 속성을 결정하는 경우 테이블을 분리하여 종속성을 제거함.

# 3. 트랜잭션, 무결성

### 정의

- **트랜잭션**: DB에서 하나의 논리적 기능을 수행하기 위한 작업 단위. 여러 쿼리를 하나로 묶는 실행 단위임.

### Atomicity

- **의미**: 트랜잭션 내의 모든 작업이 완전하게 수행되거나, 전혀 수행되지 않아야 함.
- **예시**: 은행 계좌 이체에서 출금과 입금 작업이 모두 성공하거나, 모두 취소되는 경우.
- **commit**: 트랜잭션 작업이 성공적으로 완료되어 영구 저장되는 상태.
- **rollback**: 트랜잭션 작업이 실패하거나 중단되어 이전 상태로 복구되는 상태.
- **트랜잭션 전파**: 트랜잭션이 호출된 작업 간에 전달되는 방식을 제어하는 메커니즘.

### Consistency

- **의미**: 트랜잭션 수행 전후에 데이터베이스가 일관된 상태를 유지해야 함.
- **예시**: 은행 계좌 잔액 계산에서 모든 트랜잭션이 완료된 후에도 전체 잔액 합계는 동일해야 함.

### Isolation

- **의미**: 여러 트랜잭션이 동시에 실행될 때 서로 간섭하지 않아야 함.
- **예시**: 동시에 실행되는 주문 생성과 재고 감소 트랜잭션이 서로 영향을 미치지 않음.
- **격리 수준**: 트랜잭션 간 간섭을 허용하는 정도를 정의하며, READ UNCOMMITTED부터 SERIALIZABLE까지 존재함.
- **격리 수준에 따라 발생하는 현상**: Dirty Read, Non-Repeatable Read, Phantom Read 등 다양한 문제 발생 가능.

### Durability

- **의미**: 트랜잭션이 성공적으로 완료되면 시스템 장애가 발생해도 결과가 유지되어야 함.
- **예시**: 결제 완료 후 데이터베이스가 복구되어도 결제 기록이 남아 있어야 함.

### 무결성

- **의미**: 데이터의 정확성과 일관성을 유지하는 성질. 제약 조건(Primary Key, Foreign Key 등)을 통해 보장됨.

# 4. DB의 종류

### RDB vs NoSQL

- **RDB**: 고정된 스키마를 가지며, 관계를 기반으로 데이터를 저장함. 데이터 일관성이 높음.
- **NoSQL**: 비정형 데이터를 저장할 수 있는 유연한 구조를 제공하며, 높은 확장성을 가짐.

### MySQL

- **특징**: 관계형 데이터베이스로, 오픈소스와 상용 라이선스 모두 지원. 간편한 사용성과 높은 성능 제공.
- **원리**: 데이터 저장 시 테이블을 기반으로 관계를 설정하며, SQL 쿼리를 통해 데이터 조작을 수행함.
- **활용예시**: 전자상거래, 블로그 시스템 등 구조화된 데이터를 사용하는 애플리케이션.

### PostgreSQL

- **특징**: 고급 기능을 제공하는 오픈소스 RDBMS. 복잡한 쿼리와 데이터 타입 지원에 강점이 있음.
- **원리**: ACID 특성을 지원하며, JSON 데이터 처리와 확장성을 통해 복합적인 요구를 충족함.
- **활용예시**: 금융 시스템, GIS 애플리케이션 등.

### MongoDB

- **특징**: 문서 지향 NoSQL 데이터베이스로, JSON 형태의 데이터를 저장함. 스키마 유연성이 높음.
- **원리**: 데이터를 컬렉션과 문서로 저장하며, 빠른 쓰기와 읽기 성능을 제공함.
- **활용예시**: 소셜 네트워크, IoT 데이터 저장 등.

### Redis

- **특징**: 키-값 저장소로, 인메모리 기반의 빠른 데이터 처리 성능 제공.
- **원리**: 데이터를 메모리에 저장하며, Pub/Sub 기능과 TTL 설정으로 다양한 애플리케이션에 사용 가능.
- **활용예시**: 캐시, 세션 저장소, 실시간 통계 처리.

# 5. 인덱스

### DB 인덱싱

- **의미**: 데이터를 빠르게 검색하기 위해 생성하는 데이터 구조.
- **효율적인 이유**: 검색 시간을 줄이고, 디스크 I/O를 최소화함.
- **대수 확장성**: 데이터 크기가 증가해도 상대적으로 일정한 성능을 유지함.

### B-tree

- **구조**: 계층적으로 데이터를 정렬하여 저장하는 트리 구조. 노드 간 균형 유지.
- **원리**: 검색, 삽입, 삭제 작업에서 로그 시간 복잡도를 보장함.

### 만드는 방법

- **MySQL**: CREATE INDEX 문을 통해 테이블 컬럼에 인덱스를 생성함.
- **MongoDB**: db.collection.createIndex() 메서드를 사용하여 인덱스를 생성함.

### 최적화 기법

1. **인덱스는 비용이다**: 인덱스를 과도하게 생성하면 쓰기 성능이 저하될 수 있음.
2. **항상 테스팅하라**: 쿼리 실행 계획을 확인하여 적절한 인덱스를 적용함.
3. **복합 인덱스는 같음-정렬-다중 값-카디널리티 순이다**: 가장 자주 검색되는 조건을 우선적으로 포함함.

# 6. 조인

### 종류

- **Inner Join**: 두 테이블 간의 공통된 데이터만 결합하여 반환함.
- **Left Outer Join**: 왼쪽 테이블의 모든 데이터와 오른쪽 테이블의 일치하는 데이터를 반환함.
- **Right Outer Join**: 오른쪽 테이블의 모든 데이터와 왼쪽 테이블의 일치하는 데이터를 반환함.
- **Full Outer Join**: 두 테이블의 모든 데이터를 결합하여 반환하며, 일치하지 않는 데이터도 포함함.

### 원리

- **Nested Loop Join**: 한 테이블의 각 행에 대해 다른 테이블을 반복적으로 검색함.
- **Sort Merge Join**: 두 테이블을 정렬한 후 병합하여 데이터를 결합함. 정렬이 선행되어야 성능이 높음.
- **Hash Join**: 해시 테이블을 생성하여 빠르게 데이터를 결합함. 메모리 사용량이 많지만 대용량 데이터에서 효과적임.